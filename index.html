<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Nocturnal Randomonium Emporium</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .panel {
            background-color: #2D3748; /* Darker gray background for panels */
            color: #E2E8F0; /* Light text color for panels */
            border: 1px solid #4A5568; /* Subtle border */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); /* Adjusted shadow */
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .panel:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.2), 0 4px 6px -2px rgba(0, 0, 0, 0.1);
        }
        .spinning-donut-img {
            width: 80px; /* Make it a bit bigger */
            height: 80px;
            object-fit: contain; /* Ensure the whole donut is visible */
            animation: spin 3s linear infinite; /* Slower spin */
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Adjust input colors for dark theme */
        input[type="color"] {
            background-color: #4A5568;
            border: 1px solid #718096;
            border-radius: 4px;
        }
        input[type="color"]::-webkit-color-swatch-wrapper { padding: 0; }
        input[type="color"]::-webkit-color-swatch { border: none; border-radius: 3px; }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen py-8">
    <div class="container mx-auto grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 p-4">

        <div class="panel rounded-xl p-6">
            <h2 class="text-2xl font-bold mb-4 text-white">Color Crafter</h2>
            <input type="color" id="colorPicker" class="w-full h-12 rounded-md cursor-pointer mb-4">
            <button id="randomColorButton" class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-lg w-full transition duration-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-opacity-50 mb-4">
                Random Color
            </button>
            <div id="selectedColor" class="mt-4 p-3 rounded-md flex items-center justify-between text-gray-200" style="background-color: #ffffff; border: 1px solid #4A5568;">
                <span>Selected:</span> <span id="colorValue" class="font-mono text-lg font-semibold">#ffffff</span>
            </div>
        </div>

        <div class="panel rounded-xl p-6 flex flex-col justify-between">
            <h2 class="text-2xl font-bold mb-4 text-white">Quantum Number Generator</h2>
            <p id="randomNumberDisplay" class="text-4xl font-extrabold text-indigo-400 text-center flex-grow flex items-center justify-center">? ? ?</p>
            <button id="generateNumber" class="mt-4 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-lg transition duration-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-50">Generate</button>
        </div>

        <div class="panel rounded-xl p-6 flex flex-col justify-between">
            <h2 class="text-2xl font-bold mb-4 text-white">Emoticon Alchemist</h2>
            <p id="randomEmojiDisplay" class="text-7xl text-center flex-grow flex items-center justify-center">‚ú®</p>
            <button id="generateEmoji" class="mt-4 bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-3 px-6 rounded-lg transition duration-200 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-opacity-50">Transmute Emoji</button>
        </div>

        <div class="panel rounded-xl p-6 flex flex-col justify-between">
            <h2 class="text-2xl font-bold mb-4 text-white">The Forbidden Button</h2>
            <p class="text-sm text-red-300 mb-4 flex-grow flex items-center">
                <span class="mr-2 text-xl">‚ö†Ô∏è</span> **Warning:** This button initiates an infinite loop. Your browser tab *will* become unresponsive, requiring a manual force-close. Proceed with extreme caution.
            </p>
            <button id="crashBrowser" class="bg-red-700 hover:bg-red-800 text-white font-bold py-3 px-6 rounded-lg transition duration-200 focus:outline-none focus:ring-2 focus:ring-red-600 focus:ring-opacity-50">DO NOT PRESS (Unless You Dare)</button>
        </div>

        <div class="panel rounded-xl p-6 flex items-center justify-center flex-col">
            <h2 class="text-2xl font-bold mb-4 text-white">The Perpetual Pastry</h2>
            <img src="https://images.unsplash.com/photo-1541544714124-b62040e34b17?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w1ODUwODl8MHwxfHNlYXJjaHwyMHx8ZG9udXQlMjBmb29kfGVufDB8fHx8MTcwNDgxNDc2Mnww&ixlib=rb-4.0.3&q=80&w=400" alt="Spinning Donut" class="spinning-donut-img">
            <p class="text-sm mt-4 text-gray-400">Freshly baked, perpetually spinning!</p>
        </div>

        <div class="panel rounded-xl p-6 flex flex-col justify-between">
            <h2 class="text-2xl font-bold mb-4 text-white">Serendipitous Snapshot</h2>
            <div id="imageDisplayWrapper" class="w-full h-48 bg-gray-700 rounded-md flex items-center justify-center overflow-hidden mb-4 relative">
                <span id="imagePlaceholder" class="text-gray-400 italic text-center p-2 absolute inset-0 flex items-center justify-center">Click to load a random visual marvel...</span>
                <img id="randomImage" src="" alt="Random Image" class="absolute inset-0 object-cover w-full h-full hidden">
                <span id="imageLoadingIndicator" class="text-gray-400 italic absolute inset-0 flex items-center justify-center hidden">Loading...</span>
                <span id="imageError" class="text-red-400 italic absolute inset-0 flex items-center justify-center hidden">Failed to load image.</span>
            </div>
            <button id="generateImage" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-6 rounded-lg transition duration-200 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-opacity-50">Capture Randomness</button>
        </div>

    </div>

    <script>
        // Helper function to update color display
        function updateColorDisplay(color) {
            selectedColorDiv.style.backgroundColor = color;
            colorValueSpan.textContent = color;
            // Adjust text color for contrast
            const r = parseInt(color.slice(1, 3), 16);
            const g = parseInt(color.slice(3, 5), 16);
            const b = parseInt(color.slice(5, 7), 16);
            const brightness = (r * 299 + g * 587 + b * 114) / 1000;
            if (brightness < 128) {
                selectedColorDiv.style.color = '#E2E8F0'; // Light text
                colorValueSpan.style.color = '#E2E8F0'; // Light text
            } else {
                selectedColorDiv.style.color = '#2D3748'; // Dark text
                colorValueSpan.style.color = '#2D3748'; // Dark text
            }
        }

        // Color Picker
        const colorPicker = document.getElementById('colorPicker');
        const randomColorButton = document.getElementById('randomColorButton');
        const selectedColorDiv = document.getElementById('selectedColor');
        const colorValueSpan = document.getElementById('colorValue');

        colorPicker.addEventListener('input', (event) => {
            updateColorDisplay(event.target.value);
        });

        randomColorButton.addEventListener('click', () => {
            const randomHexColor = `#${Math.floor(Math.random()*16777215).toString(16).padStart(6, '0')}`;
            colorPicker.value = randomHexColor; // Update the input itself
            updateColorDisplay(randomHexColor); // Update the display
        });


        // Random Number
        const randomNumberDisplay = document.getElementById('randomNumberDisplay');
        const generateNumberButton = document.getElementById('generateNumber');

        generateNumberButton.addEventListener('click', () => {
            const randomNumber = Math.floor(Math.random() * 99999) + 1; // 1 to 99999
            randomNumberDisplay.textContent = randomNumber;
        });

        // Random Emoji
        const randomEmojiDisplay = document.getElementById('randomEmojiDisplay');
        const generateEmojiButton = document.getElementById('generateEmoji');
        const emojis = ["üòÇ", "üòä", "üòé", "ü•≥", "ü§Ø", "ü§î", "üòç", "üëç", "üéâ", "üéà", "üéÅ", "üåü", "üí´", "üåà", "‚ú®", "üöÄ", "üçï", "üê¢", "ü¶Ñ", "üëΩ", "ü§ñ", "üêô", "üçÑ", "üîÆ", "üß™", "üß¨", "üíé"];

        generateEmojiButton.addEventListener('click', () => {
            const randomEmoji = emojis[(Math.floor(Math.random() * emojis.length))];
            randomEmojiDisplay.textContent = randomEmoji;
        });

        // Crash Your Browser
        const crashBrowserButton = document.getElementById('crashBrowser');
        crashBrowserButton.addEventListener('click', () => {
            let i = 0;
            // This is the infamous infinite loop that freezes the tab
            while (true) {
                console.log("Crashing...", i++);
            }
        });

        // Random Image
        const imageDisplayWrapper = document.getElementById('imageDisplayWrapper');
        const randomImage = document.getElementById('randomImage');
        const imagePlaceholder = document.getElementById('imagePlaceholder');
        const imageLoadingIndicator = document.getElementById('imageLoadingIndicator');
        const imageError = document.getElementById('imageError');
        const generateImageButton = document.getElementById('generateImage');

        // *** CHANGED THIS URL TO PICSUM PHOTOS FOR RELIABILITY ***
        const imageUrl = 'https://picsum.photos/400/300'; // More reliable random image source

        generateImageButton.addEventListener('click', () => {
            // Hide all potential messages and the image, show loading indicator
            imagePlaceholder.classList.add('hidden');
            imageError.classList.add('hidden');
            randomImage.classList.add('hidden');
            imageLoadingIndicator.classList.remove('hidden');

            // Add a unique timestamp to the URL to ensure a fresh image is loaded every time
            randomImage.src = `${imageUrl}?random=${new Date().getTime()}`;

            randomImage.onload = () => {
                imageLoadingIndicator.classList.add('hidden');
                randomImage.classList.remove('hidden');
                imagePlaceholder.classList.add('hidden'); // Ensure placeholder is hidden after successful load
            };

            randomImage.onerror = () => {
                imageLoadingIndicator.classList.add('hidden');
                imageError.classList.remove('hidden');
                randomImage.classList.add('hidden'); // Keep image hidden on error
                imagePlaceholder.classList.add('hidden'); // Ensure placeholder is hidden on error
            };
        });

        // Initialize display states on page load
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize the color picker display
            const initialColor = colorPicker.value;
            updateColorDisplay(initialColor);

            // Initialize the image panel with placeholder visible
            imagePlaceholder.classList.remove('hidden');
            randomImage.classList.add('hidden');
            imageLoadingIndicator.classList.add('hidden');
            imageError.classList.add('hidden');
        });
    </script>
</body>
</html>
